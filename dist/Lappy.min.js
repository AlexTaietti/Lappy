!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.lappy=e():t.lappy=e()}(window,(function(){return function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/js/",o(o.s=0)}([function(t,e,o){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}o.r(e),o.d(e,"BasicOverlapObject",(function(){return c})),o.d(e,"ActiveOverlapObject",(function(){return p})),o.d(e,"Lappy",(function(){return C}));var r={mergeObjects:function(t){function e(e,o,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e,o){for(var r in t)e.hasOwnProperty(r)&&("object"===n(e[r])&&o?mergeObjects(t[r],e[r],!0):t[r]=e[r]);return t})),getDocumentHeight:function(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)},getDocumentWidth:function(){return Math.max(document.documentElement.clientWidth,document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth)},getInnerCoords:function(t){var e=[],o=t.offsetWidth,n=t.offsetHeight;return e[0]={y:t.getBoundingClientRect().y+window.scrollY,x:t.getBoundingClientRect().x+window.scrollX},e[1]={y:t.getBoundingClientRect().y+window.scrollY,x:t.getBoundingClientRect().x+window.scrollX+o},e[2]={y:t.getBoundingClientRect().y+window.scrollY+n,x:t.getBoundingClientRect().x+window.scrollX+o},e[3]={y:t.getBoundingClientRect().y+window.scrollY+n,x:t.getBoundingClientRect().x+window.scrollX},e},getOuterCoords:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:null,y:null},n=[],r=t.offsetWidth,i=t.offsetHeight;return n[0]={y:o.y?t.getBoundingClientRect().y+window.scrollY-e.y:0,x:o.x?t.getBoundingClientRect().x+window.scrollX-e.x:0},n[1]={y:o.y?t.getBoundingClientRect().y+window.scrollY-e.y:0,x:o.x?t.getBoundingClientRect().x+window.scrollX+r+e.x:window.innerWidth},n[2]={y:o.y?t.getBoundingClientRect().y+window.scrollY+i+e.y:window.innerHeight,x:o.x?t.getBoundingClientRect().x+window.scrollX+r+e.x:window.innerWidth},n[3]={y:o.y?t.getBoundingClientRect().y+window.scrollY+i+e.y:window.innerHeight,x:o.x?t.getBoundingClientRect().x+window.scrollX-e.x:0},n}};function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function t(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.offset,a=o.axis;i(this,t);var c={offset:{x:0,y:0},axis:{x:!0,y:!0}};this.HTML=e,this.offset=n||c.offset,this.axis=a||c.axis,this.active=!1,this.htmlCoordinates=r.getInnerCoords(e),this.coordinates=r.getOuterCoords(e,this.offset,this.axis)}var e,o,n;return e=t,(o=[{key:"updateCoordinates",value:function(){this.htmlCoordinates=r.getInnerCoords(this.HTML),this.coordinates=r.getOuterCoords(this.HTML,this.offset,this.axis)}}])&&a(e.prototype,o),n&&a(e,n),t}();function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=y(t);if(e){var r=y(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return f(this,o)}}function f(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(a,t);var e,o,n,i=h(a);function a(t){var e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(this,a),(e=i.call(this,t,o)).active=!0,e.trackedObjects=[],e}return e=a,(o=[{key:"updateCoordinates",value:function(){this.htmlCoordinates=r.getInnerCoords(this.HTML),this.coordinates=r.getOuterCoords(this.HTML,this.offset,this.axis);for(var t=0;t<this.trackedObjects.length;t++)this.trackedObjects[t].object.updateCoordinates()}},{key:"addTrackedObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={onApproach:function(t,e){return 1},onOverlap:function(t,e){return 1},onExit:function(t,e){return 1},onLeave:function(t,e){return 1}};if(NodeList.prototype.isPrototypeOf(t))for(var i=0;i<t.length;i++)this.trackedObjects.push({object:t instanceof c?t:new c(t[i],o),callbacks:r.mergeObjects(n,e),lastOverlapData:{x:null,y:null}});else this.trackedObjects.push({object:t instanceof c?t:new c(t,o),callbacks:r.mergeObjects(n,e),lastOverlapData:{x:null,y:null}})}}])&&u(e.prototype,o),n&&u(e,n),a}(c);function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var b=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};x(this,t);var o={context:void 0,approachColor:"red"},n=r.mergeObjects(o,e);this.context=n.context,this.approachColor=n.approachColor,this.paused=!1}var e,o,n;return e=t,(o=[{key:"displayCoordinates",value:function(t){this.context.beginPath(),this.context.fillStyle="black",this.context.textAlign="center",this.context.textBaseline="middle",this.context.fillText("x:".concat(~~t.htmlCoordinates[0].x,", y:").concat(~~t.htmlCoordinates[0].y),~~t.htmlCoordinates[0].x,~~t.htmlCoordinates[0].y-15),this.context.fillText("x:".concat(~~t.htmlCoordinates[1].x,", y:").concat(~~t.htmlCoordinates[1].y),~~t.htmlCoordinates[1].x,~~t.htmlCoordinates[1].y-15),this.context.fillText("x:".concat(~~t.htmlCoordinates[2].x,", y:").concat(~~t.htmlCoordinates[2].y),~~t.htmlCoordinates[2].x,15+~~t.htmlCoordinates[2].y),this.context.fillText("x:".concat(~~t.htmlCoordinates[3].x,", y:").concat(~~t.htmlCoordinates[3].y),~~t.htmlCoordinates[3].x,15+~~t.htmlCoordinates[3].y),this.context.closePath()}},{key:"drawApproachArea",value:function(t){this.context.beginPath(),this.context.strokeStyle=this.approachColor,this.context.setLineDash([5,10]),this.context.strokeRect(t.coordinates[0].x,t.coordinates[0].y,t.coordinates[2].x-t.coordinates[0].x,t.coordinates[2].y-t.coordinates[0].y),this.context.stroke(),this.context.closePath()}},{key:"display",value:function(t){if(this.displayCoordinates(t),(t.offset.x||t.offset.y)&&this.drawApproachArea(t),t.active&&t.trackedObjects.length)for(var e=0;e<t.trackedObjects.length;e++)this.display(t.trackedObjects[e].object)}},{key:"clearTestDisplay",value:function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)}},{key:"pause",value:function(){this.clearTestDisplay(),this.paused=!0}},{key:"resume",value:function(){this.paused=!1}}])&&v(e.prototype,o),n&&v(e,n),t}();function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var C=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.graphicalTest;g(this,t),o&&(this.graphicalTest=new b(o)),this.overlapObjects=[]}var e,o,n;return e=t,(o=[{key:"addActiveObject",value:function(t){this.overlapObjects.push(t)}},{key:"resizeGraphicalTestCanvas",value:function(){this.graphicalTest.context.canvas.width=r.getDocumentWidth(),this.graphicalTest.context.canvas.height=r.getDocumentHeight()}},{key:"checkOverlapY",value:function(t,e){return t.htmlCoordinates[2].y-e.htmlCoordinates[0].y>=0&&t.htmlCoordinates[2].y-e.htmlCoordinates[2].y<=0?1:t.htmlCoordinates[0].y-e.htmlCoordinates[2].y<=0&&t.htmlCoordinates[0].y-e.htmlCoordinates[0].y>=0?-1:t.coordinates[2].y-e.coordinates[0].y>=0&&t.coordinates[2].y-e.coordinates[2].y<=0?2:t.coordinates[0].y-e.coordinates[2].y<=0&&t.coordinates[0].y-e.coordinates[0].y>=0?-2:0}},{key:"checkOverlapX",value:function(t,e){return t.htmlCoordinates[2].x-e.htmlCoordinates[0].x>=0&&t.htmlCoordinates[2].x-e.htmlCoordinates[2].x<=0?1:t.htmlCoordinates[0].x-e.htmlCoordinates[2].x<=0&&t.htmlCoordinates[0].x-e.htmlCoordinates[0].x>=0?-1:t.coordinates[2].x-e.coordinates[0].x>=0&&t.coordinates[2].x-e.coordinates[2].x<=0?2:t.coordinates[0].x-e.coordinates[2].x<=0&&t.coordinates[0].x-e.coordinates[0].x>=0?-2:0}},{key:"updateCoordinates",value:function(){for(var t=0;t<this.overlapObjects.length;t++)this.overlapObjects[t].updateCoordinates()}},{key:"calculateOverlap",value:function(t,e){var o=this.checkOverlapX(t,e),n=this.checkOverlapY(t,e);return{x:t.axis.x?o:n,y:t.axis.y?n:o}}},{key:"checkOverlap",value:function(t,e){var o=this.calculateOverlap(t,e.object);o.x&&o.y?Math.abs(o.x)===Math.abs(o.y)?o.x%2==0&&o.y%2==0?(o.x+e.lastOverlapData.x)%3==0&&o.x*e.lastOverlapData.x>0&&o.x%2==0||(o.y+e.lastOverlapData.y)%3==0&&o.y*e.lastOverlapData.y>0&&o.y%2==0?e.callbacks.onExit(t.HTML,e.object.HTML):e.callbacks.onApproach(t.HTML,e.object.HTML):e.callbacks.onOverlap(t.HTML,e.object.HTML):o.x%2!=0&&o.y%2!=0||((o.x+e.lastOverlapData.x)%3==0&&o.x*e.lastOverlapData.x>0&&o.x%2==0||(o.y+e.lastOverlapData.y)%3==0&&o.y*e.lastOverlapData.y>0&&o.y%2==0?e.callbacks.onExit(t.HTML,e.object.HTML):e.callbacks.onApproach(t.HTML,e.object.HTML)):o.x&&o.y||!e.lastOverlapData.x||!e.lastOverlapData.y||e.callbacks.onLeave(t.HTML,e.object.HTML),e.lastOverlapData=o}},{key:"displayGraphicalTest",value:function(){this.updateCoordinates(),this.graphicalTest.clearTestDisplay();for(var t=0;t<this.overlapObjects.length;t++)this.graphicalTest.display(this.overlapObjects[t])}},{key:"addGraphicalTest",value:function(t){if(this.graphicalTest)throw"Graphical test already initialised!";this.graphicalTest=new b(t),this.resizeGraphicalTestCanvas()}},{key:"watch",value:function(){this.updateCoordinates(),this.graphicalTest&&!this.graphicalTest.paused&&this.displayGraphicalTest();for(var t=0;t<this.overlapObjects.length;t++)for(var e=this.overlapObjects[t],o=0;o<e.trackedObjects.length;o++)this.checkOverlap(e,e.trackedObjects[o])}}])&&m(e.prototype,o),n&&m(e,n),t}()}])}));
//# sourceMappingURL=Lappy.min.js.map